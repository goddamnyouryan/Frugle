<!DOCTYPE html>
<html>
<head>
  <title>Frugle | <%= content_for?(:title) ? yield(:title) : "" %></title>
	<% if (params[:controller] == "businesses" && params[:action] == "show") || (params[:controller] == "home" && params[:action] == "index")  %>
		<% unless current_user.role =="business" %>
			<%= raw(GMap.header) %>
			<%= raw(@map.to_html) %>
	<% else %>
		<%= raw(GMap.header) %>
		<%= raw(@map.to_html) %>		
	<% end %>
	<% end %>
  <%= stylesheet_link_tag "scaffold" %>
  <%= javascript_include_tag :defaults %>
	<%= csrf_meta_tag %>
  <%= yield(:head) %>
</head>
<body>
	
	<h1><%= link_to "Frugle", root_path%></h1>
	
	<% if user_signed_in? %>
		<% unless current_user.role == "business" %>
		<p id="neighborhood"><%= current_user.neighborhood.name %> <%= link_to "(change)", edit_neighborhood_path(current_user), :remote => true %></p>
		<% end %>
	<% else %>
		<% if session[:neighborhood]%>
			<% @neighborhood = Neighborhood.find session[:neighborhood] %>
			<p id="neighborhood"><%= @neighborhood.name %> <%= link_to "(change)", edit_neighborhood_path(@neighborhood), :remote => true %></p>
		<% end %>
	<% end %>
	
	<nav>
	  <% if user_signed_in? %>
	    Signed in as <%= current_user.email %>.
		<%= link_to "Account Settings", edit_user_registration_path %> or
		<% if current_user.role == "business" %>
			<%= link_to "Verify a Frugle", verify_path %> or 
		<% end %>
	    <%= link_to "Sign out", destroy_user_session_path %>
	  <% else %>
	    <%= link_to "Sign up", new_user_registration_path %> or <%= link_to "sign in", new_user_session_path %>
	  <% end %>
	</nav>
	
	<div class="clear"></div>

	<div id="container">
      <% flash.each do |name, msg| %>
        <%= content_tag :div, msg, :id => "flash_#{name}" %>
      <% end %>
      <%= content_tag :h2, yield(:title) if show_title? %>
      <%= yield %>
    </div>

	<footer>
		&copy;2011 Frugle
	</footer>
	
	<% if ENV["RAILS_ENV"] == "development" %>
		<%= request.session_options[:id] %>
		<%= debug(params) %>
	<% end %>

</body>
</html>
